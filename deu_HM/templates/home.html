{% extends 'base.html' %}
{% load bootstrap5 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
{% load static %}
{%  from .models import Note % }


{% block content %}
<!-- Contenido específico de la página de inicio -->
<meta charset="utf-8">
<script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>



<link rel="stylesheet" href="{% static 'css/modal.css' %}">
<style>
  body { margin: 0; padding: 0; }
  #map { position: absolute; top: 0; bottom: 0; width: 100%; }
</style>

</head>
</button>
  <body>
      <div id="map" ></div>
    <script>
      mapboxgl.accessToken = 'pk.eyJ1IjoibGVlc2FuNjQiLCJhIjoiY2xrNnptbWtkMDNpYjNrbnoxZHltZmhtbiJ9.hDEJKjc9Cq2708RJIHigIA';
      var map = new mapboxgl.Map({
          container: 'map', // container ID
          // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
          style: 'mapbox://styles/mapbox/streets-v12', // style URL
          center: [-58.381485, -34.603969], // starting position [lng, lat]
          zoom: 9 // starting zoom
      });
    </script>
    <script>
    fetch('/get_notas/')
    .then(response => response.json())
    .then(data => {
        data.forEach(nota => {
            // Agrega el marcador al mapa
            const marker = new mapboxgl.Marker()
                .setLngLat([nota.long, nota.lat])
                .setPopup(new mapboxgl.Popup().setHTML(`<h3>${nota.titulo}</h3><p>${nota.texto}</p>`))
                .addTo(map);
        });
    })
    .catch(error => {
        console.error('Error al obtener los datos:', error);
    });
    </script>
    </body>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="container">
            <h1>Agregue una nueva nota</h1>
            <form action="" method=POST>
                {% csrf_token %}
            <div class="form-group">
                {{ formu.as_p }}
            </div>
            <div class="form-group">
                <input class="btn btn-success" type="submit" value="Submit">
            </div>
            </form>
        </div>
        </div>
      </div>    
    </div>
    {% endblock %}


